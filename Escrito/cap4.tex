\chapter{$\tau$-HYPERNEAT}

Una vez comprendido el funcionamiento del método de neuroevolución HyperNEAT es posible extenderlo para implementar el nuevo método \(\tau\)-HyperNEAT propuesto. Este método poseerá la misma estructura que su predecesor, con una configuración definida del substrato y una población inicial de organismos CPPN de topología básica únicamente diferenciados por la aleatoriedad de la asignación de los pesos de sus conexiones. Sin embargo, la topología básica inicial de estos organismos será diferente que para el caso de HyperNEAT. Además de que una red CPPN entregue el peso como resultado de la consulta de una conexión entre dos nodos dentro del substrato, entregará un segundo valor correspondiente al porcentaje de retardo (con respecto a un retardo máximo) asignado a la conexión entre dichos nodos. El retardo de conexión es implementado en el substrato por medio de un \textit{buffer}, el cual poseerá un largo proporcional al retardo.

La figura \ref{tauhyperneat} muestra un esquema del método \(\tau\)-HyperNEAT propuesto, el cual es muy similar al esquema de la figura \ref{hyperneat}. Una red CPPN se encarga de generar un patrón de conectividad entre todos los nodos ubicados en el substrato, tomando como entradas las coordenadas de los nodos (fuente y destino), y retornando el peso y el porcentaje de retardo en la conexión entre estos nodos. De esta forma, la red CPPN calcula entonces cada conexión potencial en el substrato. Tal como ocurre en el método HyperNEAT en donde la distribución de los pesos en las conexiones a lo largo del substrato exhibe un patrón en función de las geometrías del sistema de coordenadas del substrato, los retardos también estarán distribuidos en función de este.

\begin{figure}[t]
\centering
\includegraphics[width=0.8\textwidth]{fig/usmLogo.png}
\caption{\textbf{Interpretación del patrón geométrico de conectividad de un hipercubo usando \(\tau\)-HyperNEAT. } Al igual que como funciona el método HyperNEAT (1) cada conexión potencial es consultada para determinar si esta existe, y de existir, cual sería su peso y su retardo asociado. (2) Por cada consulta, la red CPPN toma como entrada las coordenadas de los dos puntos terminales y (3) entrega como salida el peso y el retardo de la conexión entre ellos. Luego de que todas las conexiones han sido determinadas, un patrón de conexiones, pesos y retardos de conexión resultan en función de la geometría del substrato.}
\label{tauhyperneat}
\end{figure}

En este caso, la red CPPN calcula una función $\text{CPPN}(x_{1}, y_{1}, x_{2}, y_{2})= [ \omega,\tau ]$ de cuatro dimensiones, al igual que en el caso de HyperNEAT, en donde el primer nodo se encuentra en la coordenada $(x_{1}, y_{1})$ y el segundo en $(x_{2}, y_{2})$. Sin embargo, a diferencia de su predecesor, a partir de esta función se retorna un vector de largo dos, compuesto por el peso y el retardo de cada una de las conexiones entre cada nodo en la red. Tal como funciona en HyperNEAT, una conexión no se realiza si la magnitud del peso resultante de la función $\text{CPPN}$, que puede ser positiva o negativa, se encuentra por debajo de un umbral mínimo $\omega_{min}$. Las magnitudes de los pesos por sobre este umbral son escalados entre cero y una magnitud máxima definida para la red. El resultado correspondiente al retardo no tiene ninguna implicancia al momento de decidir si una conexión es o no factible, y solo entrega información adicional del comportamiento de cada conexión. El porcentaje de retardo obtenido es multiplicado por el retardo máximo $\tau_{max}$ (número entero positivo correspondiente al tamaño máximo asignable al buffer de retardo) dado para la red, y  es aproximado al número entero más próximo, obteniendo como resultado el tamaño del buffer de retardo. La figura \ref{buffer} muestra como es el comportamiento del buffer a cada iteración de la red.

\begin{figure}[t]%hacer esto
\centering
\includegraphics[width=0.8\textwidth]{fig/usmLogo.png}
\caption{\textbf{Funcionamiento del buffer de retardo. } lalallaa}
\label{buffer}
\end{figure}

Cada nodo del substrato, en primera instancia, recibirá como entrada los valores de salida de cada uno de los demás nodos conectados a él multiplicados por sus respectivos pesos. Estos valores